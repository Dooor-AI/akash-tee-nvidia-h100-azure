# docker-compose.yml
version: '3'
services:
  webhook:
    build: 
      context: ./webhook
      platforms:
        - linux/amd64
    image: brunolaureano/gpu-webhook:latest
  attestation:
    build:
      context: ./sidecar
      platforms:
        - linux/amd64
    image: brunolaureano/gpu-attestation:latest
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    deploy:
      resources:
        reservations:
          devices:
          - driver: nvidia
            count: 1
            capabilities: [gpu]